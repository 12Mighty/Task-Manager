### Документация для проекта "Task Manager"

#### Описание

Проект "Task Manager" — это система для управления задачами и проектами с использованием Flask и SQLite. В системе есть три типа пользователей: **администратор**, **менеджер** и **работник**. Каждый пользователь имеет доступ к разным функциям в зависимости от своей роли. Администратор может управлять всеми пользователями, менеджер может создавать и назначать задачи, а работник — выполнять задачи, назначенные ему.

---

#### Как установить

1. **Клонируем репозиторий**:
   Чтобы получить проект, используем команду:
   ```bash
   git clone https://github.com/yourusername/task-manager.git
   ```

2. **Создаём виртуальное окружение**:
   Для начала создадим виртуальное окружение, чтобы все библиотеки установились только для этого проекта:
   ```bash
   python3 -m venv venv
   source venv/bin/activate  # Для Linux/macOS
   venv\Scripts\activate     # Для Windows
   ```

3. **Устанавливаем зависимости**:
   Все зависимости проекта находятся в файле `requirements.txt`. Установим их с помощью pip:
   ```bash
   pip install -r requirements.txt
   ```

4. **Инициализация базы данных**:
   Чтобы создать структуру базы данных и добавить администратора, нужно выполнить команду:
   ```bash
   flask init-db
   ```

5. **Запускаем приложение**:
   После того как все настроено, запускаем сервер:
   ```bash
   flask run
   ```

   Теперь приложение доступно по адресу `http://127.0.0.1:5000/`.

---

#### Структура проекта

- **app.py** — основной файл, где настроены маршруты и обработка запросов.
- **schema.sql** — SQL-скрипт для создания таблиц в базе данных.
- **templates/** — папка с HTML-шаблонами для отображения страниц.
- **instance/** — папка, где хранится база данных и конфигурационные файлы.

---

#### Модели данных

В проекте используется база данных SQLite с несколькими таблицами:

1. **Пользователи (`users`)**:
   - `id`: уникальный идентификатор.
   - `username`: имя пользователя.
   - `password`: зашифрованный пароль.
   - `role`: роль пользователя (admin, manager, worker).

2. **Проекты (`projects`)**:
   - `id`: уникальный идентификатор.
   - `name`: название проекта.
   - `description`: описание проекта.
   - `created_by`: ID пользователя, создавшего проект.

3. **Задачи (`tasks`)**:
   - `id`: уникальный идентификатор задачи.
   - `title`: название задачи.
   - `description`: описание задачи.
   - `project_id`: ID проекта, к которому относится задача.
   - `assigned_to`: ID пользователя, которому назначена задача.
   - `assigned_by`: ID пользователя, назначившего задачу.
   - `status`: статус задачи (pending, completed).

4. **Логи (`logs`)**:
   - `id`: уникальный идентификатор лога.
   - `user_id`: ID пользователя, который выполнил действие.
   - `action`: описание действия (например, login, task_completed).
   - `details`: дополнительные детали действия.

---

#### Роли пользователей

1. **Администратор**:
   - Может управлять пользователями: добавлять, изменять роли, удалять.
   - Может создавать и удалять проекты.
   - Видит все логи.

2. **Менеджер**:
   - Может создавать проекты.
   - Может назначать задачи работникам.
   - Видит только свои проекты.

3. **Работник**:
   - Видит только свои задачи.
   - Может завершать задачи.

---

#### Основные маршруты

- **/login**: Страница для входа в систему.
- **/register**: Страница для регистрации нового пользователя.
- **/logout**: Выход из системы.
- **/admin/get_users**: Список всех пользователей (только для администратора).
- **/manager/get_projects**: Список проектов, созданных текущим менеджером.
- **/manager/create_project**: Создание нового проекта.
- **/manager/create_task**: Создание новой задачи.

---

#### Инициализация базы данных

Перед тем как начать использовать приложение, нужно инициализировать базу данных. Для этого нужно выполнить команду:
```bash
flask init-db
```
Эта команда создаст все необходимые таблицы в базе данных и добавит пользователя-администратора с логином `admin` и паролем `admin123`.

---

#### Логирование действий

Все действия пользователей, такие как вход в систему, создание задач, изменение ролей, записываются в таблицу `logs`. Это помогает отслеживать, что и когда сделал каждый пользователь.

---

#### Пример команд

1. **Создание нового проекта**:
   Вызовите функцию:
   ```python
   create_project("Project Name", "Description of the project", created_by_user_id)
   ```

2. **Регистрация нового пользователя**:
   Вызовите функцию:
   ```python
   register_user("newuser", "password", "worker")
   ```

3. **Авторизация пользователя**:
   Вызовите функцию:
   ```python
   login_user("newuser", "password")
   ```

4. **Завершение задачи**:
   Вызовите функцию:
   ```python
   complete_task(task_id)
   ```

---

#### Контрибуция

Если хотите помочь в развитии проекта, создайте свой форк репозитория, внесите изменения, а затем отправьте пулл-реквест с вашими правками.

1. Форкните репозиторий.
2. Создайте новую ветку.
3. Внесите свои изменения.
4. Отправьте пулл-реквест.
